!function(a){var b={margin:5,minScrollBarSize:50,init:!1,transform3d:!1},c=["-webkit-","-moz-","-ms-",""],d=function(a,c,d){this.realScrollable=a,this.fakeScrollable=c,this.currentPos=0,this.initiated=!1,d=d||{},this.options={};for(var e in b)b.hasOwnProperty(e)&&(this.options[e]=e in d?d[e]:b[e]);this._createElements(),this._bindEvents(),this.options.init&&this.refreshDimensions()};d.prototype={constructor:d,refreshDimensions:function(){this._calculateDimensions(),this.handlingArea.style.height=Math.round(this.scrollHeight)+"px";var a=this.margin+this.relation*this.realScrollable.scrollTop;if(this._setScrollbar(a),!this.initiated){this.initiated=!0;var b=this;setTimeout(function(){b.scrollBar.className="meow-bar initiated"},0)}},_createElements:function(){this.actualBarElement=document.createElement("div"),this.handlingArea=document.createElement("div"),this.handlingArea.appendChild(this.actualBarElement),this.scrollBar=document.createElement("div"),this.scrollBar.className="meow-bar",this.scrollBar.appendChild(this.handlingArea),this.fakeScrollable.style.position="relative",this.fakeScrollable.appendChild(this.scrollBar)},_calculateDimensions:function(){var a=this.realScrollable.scrollHeight,b=d.connector.elementHeight(this.fakeScrollable),c=b-2*this.options.margin,e=c/a,f=0;a>b&&(f=e*c),this.scrollHeight=Math.max(this.options.minScrollBarSize,f),this.viewportHeight=c;var g=this.viewportHeight+f-this.scrollHeight;this.relation=g/a,this.margin=this.options.margin+d.connector.topMargin(this.fakeScrollable)},_handleDrag:function(a){var b=this,c=a.clientY;this._mousemoveHandler=function(a){b._incrementScroll(a.clientY-c),b._updateScroll(),c=a.clientY},d.connector.bindEvent(document,"mousemove",this._mousemoveHandler)},_stopDrag:function(){this._mousemoveHandler&&(d.connector.unbindEvent(document,"mousemove",this._mousemoveHandler),this._mousemoveHandler=null),this.mouseupHandler&&(d.connector.unbindEvent(document,"mouseup",this.mouseupHandler),this.mouseupHandler=null)},_updateScroll:function(){var a=(this.currentPos-this.margin)/this.relation;this.realScrollable.scrollTop=a},_setScrollbar:function(a){if(a=Math.max(this.margin,Math.min(this.viewportHeight-this.scrollHeight+this.margin,a)),this.currentPos=a,this.options.transform3d)for(var b=0;b<c.length;++b)this.handlingArea.style[c[b]+"transform"]="translate3d(0, "+a+"px, 0)";else this.handlingArea.style.top=Math.round(a)+"px";this.handlingArea.style.display=this.relation>=1?"none":"block"},_incrementScroll:function(a){this._setScrollbar(this.currentPos+a)},_bindEvents:function(){var a=this;a.scrollHandler=function(){var b=a.margin+a.relation*a.realScrollable.scrollTop;a._setScrollbar(b)},a.mousedownHandler=function(b){3!==b.which&&2!==b.button&&(d.connector.preventDefault(b),a._stopDrag(),a._handleDrag(b),a.mouseupHandler=function(b){d.connector.preventDefault(b),a._stopDrag()},d.connector.bindEvent(document,"mouseup",a.mouseupHandler))},d.connector.bindEvent(this.realScrollable,"scroll",a.scrollHandler),d.connector.bindEvent(this.scrollBar,"mousedown",a.mousedownHandler)},clearEvents:function(){this.realScrollable&&this.scrollHandler&&d.connector.unbindEvent(this.realScrollable,"scroll",this.scrollHandler),this.scrollBar&&this.mousedownHandler&&d.connector.unbindEvent(this.scrollBar,"mousedown",this.mousedownHandler),this._stopDrag()}},a.MeowBar=d}(this),function(a,b){MeowBar.connector={bindEvent:function(a,c,d){b(a).on(c,d)},unbindEvent:function(a,c,d){b(a).off(c,d)},preventDefault:function(a){a.preventDefault()},elementHeight:function(a){return b(a).height()},topMargin:function(a){return a=b(a),parseInt(a.css("margin-top"),10)+parseInt(a.css("border-top-width"),10)}}}(this,jQuery);